<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>水族天堂</title>
    <link rel="stylesheet" href="./style.css">
    <style>
        .banner {
            background: url(./img/banner5.jpg) center / cover no-repeat;
        }

        .main {
            margin: 76px auto;
            width: 100%;
            display: flex;
            justify-content: center;
            
            .container {
                width: 1320px;
                display: flex;
                flex-direction: column;
                align-items: center;
                

            }

            .step {
                display: flex;
                flex-direction: column;
                align-items: center;

                .stepText {
                    display: flex;
                    justify-content: space-between;
                    width: 492px;
                    margin-top: 8px;

                    span {
                        width: 48px;
                        text-align: center;
                        font-size: 14px;
                        color: #7E7A7A;
                    }
                }
            }

            .cart {
                margin: 76px 0;
                display: flex;
                flex-wrap: wrap;
                width: 100%;
                justify-content: space-between;

                .cartDetail {
                    width: 873px;

                    .itemName {
                        width: 41.666666%;
                    }

                    .price {
                        width: 16.666666%;
                    }

                    .counter {
                        width: 16.666666%;
                    }

                    .totalPrice {
                        width: 16.666666%;
                    }

                    .trash {
                        width: 8.333333%;
                    }

                    .cartHeader {
                        display: flex;
                        width: 100%;
                        padding: 0 24px;
                        background-color: #52867E;
                        color: #fff;
                        border-radius: 8px;
                        font-size: 20px;
                        line-height: 56px;
                    }

                    .cartBody {
                        width: 100%;
                        padding: 0 24px;

                        .cartItem {
                            width: 100%;
                            padding: 24px 0;
                            display: flex;
                            align-items: center;
                            border-bottom: 1px solid #B3B1B1;

                            .itemName {
                                display: flex;
                                align-items: center;

                                .goodsName {
                                    margin-left: 32px;

                                    h4 {
                                        font-size: 20px;
                                    }

                                    p {
                                        color: #666;
                                    }
                                }
                            }

                            .price {
                                font-size: 20px;
                            }

                            .counter {
                                .number-box {
                                    display: inline-flex;
                                    align-items: center;
                                    justify-content: center;
                                    border: 1px solid #B3B1B1;
                                    /* padding: 5px 10px; */
                                    width: 100px;
                                    height: 30px;
                                    border-radius: 6px;
                                    font-size: 16px;
                                    background: none;

                                }

                                .number-box .btn {
                                    border: none;
                                    background: none;
                                    font-size: 20px;
                                    cursor: pointer;
                                    padding: 0 12px;
                                }

                                .number-box .value {
                                    width: 40px;
                                    height: 30px;
                                    text-align: center;
                                    line-height: 30px;
                                    font-size: 16px;
                                    border-left: 1px solid #B3B1B1;
                                    border-right: 1px solid #B3B1B1;
                                }
                            }

                            .totalPrice {
                                font-size: 20px;
                            }

                            .trash {
                                img {
                                    cursor: pointer;
                                }
                            }
                        }
                        .cartItem.fadeOut {
                            transition: opacity .6s ease;
                            opacity: 0;
                            pointer-events: none; 
                        }
                    }
                }

                .summary {
                    width: 428px;
                    height: 400px;
                    border: 1px solid #B3B1B1;
                    border-radius: 8px;
                    padding: 24px 32px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: space-between;

                    .summaryTitle {
                        width: 100%;

                        h3 {
                            font-size: 20px;
                        }
                    }

                    .summaryBody {
                        width: 100%;
                        color: #666;

                        .amount {
                            display: flex;
                            flex-direction: column;
                            justify-content: center;
                            height: 166.25px;
                            border-top: 1px solid #B3B1B1;
                            border-bottom: 1px solid #B3B1B1;

                            >div {
                                padding: 8px 0;
                                display: flex;
                                justify-content: space-between;
                            }
                        }

                        .totalAmount {
                            display: flex;
                            justify-content: space-between;
                            margin: 24px 0;
                            font-size: 20px;
                            color: #000;
                        }

                    }
                }
            }

            .productSlogan {
                display: flex;
                width: 100%;
                justify-content: space-between;
                flex-wrap: wrap;

                .sloganItem {
                    display: flex;

                    .sloganText {
                        margin-left: 24px;
                        width: 250px;

                        h4 {
                            font-size: 20px;
                        }

                        p {
                            font-size: 20px;
                        }
                    }
                }
            }
        }

        /* nesting寫法會出bug */
        .checkoutBtn a {
            display: inline-block;
            width: 366px;
            height: 62px;
            background-color: #008CEB;
            border-radius: 150px;
            text-align: center;
            line-height: 62px;
            color: #fff;
            font-size: 24px;
            letter-spacing: 2px;
        }

        .checkoutBtn a:hover {
            background-color: #0071BE;
        }

        .deleteModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 99999999;
            background-color: #0005;

            .deleteModalContainer {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%,-50%);
                width: 540px;
                height: 320px;
                background-color: #fff;
                border-radius: 4px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                gap: 25%;
                h4 {
                    font-size: 24px;
                }
                p {
                    letter-spacing: 2px;
                }
                .btns {
                    display: flex;
                    width: 100%;
                    justify-content: center;
                    gap: 16px;
                    .btn {
                        width: 45%;
                        height: 40px;
                        border-radius: 4px;
                        letter-spacing: 2px;
                        
                    }
                    .confirm {
                        background-color: #52867E;
                        border: none;
                        color: #fff;
                    }
                    .confirm:hover {
                        background-color: #366860;
                    }
                    .cancel {
                        background-color: #fff0;
                        border: 1px solid #B3B1B1;
                        color: #666;
                    }
                    .cancel:hover {
                        background-color: #e4e4e455;
                    }
                }
            }
        }
        .deleteModal.show {
            display: block;
        }

        @media screen and (max-width: 1335px) {
            .main {
                .container {
                    width: 100%;
                    .cart {
                        flex-direction: column;
                        align-items: center;
                        width: 90%;
                        .cartDetail {
                            width: 100%;
                        }
                        .summary {
                            width: 100%;
                            border: none;
                        }
                    }

                    .productSlogan {
                        justify-content: center;
                        .sloganItem {
                            margin-bottom: 32px;
                        }
                    }
                }
            }
        }

        @media screen and (max-width: 1024px) {
            .main {
                .productSlogan {
                            /* flex-direction: column;
                            align-items: center; */
    
                            .sloganItem {
                                .sloganText {
                                    width: 185px;
                                    h4 {
                                        font-size: 20px;
                                    }
                                    p {
                                        font-size: 16px;
                                    }
                                }
                            }
                        }
            }
        }
        @media screen and (max-width: 768px) {
            .main .container{
                .step {
                    img {
                        width: 360px;
                    }
                    .stepText {
                        width: 344px;
                    }
                }
                .cart {
                    margin-bottom: 32px;
                    .cartDetail {
                        .itemName {
                            width: 50%;
                        }

                        .price {
                            width: 15%;
                        }

                        .counter {
                            width: 22.5%;
                        }

                        .totalPrice {
                            display: none;
                        }

                        .trash {
                            width:12.5%;
                        }

                        .cartBody {


                            .cartItem {


                                .itemName {


                                    .goodsName {
                                        margin-left: 16px;

                                        h4 {
                                            font-size: 16px;
                                        }

                                        p {
                                            font-size: 14px;
                                        }
                                    }
                                }

                                .price {
                                    font-size: 16px;
                                }

                                .counter {
                                    .number-box {
                                        width: 80px;
                                        height: 30px;
                                        font-size: 14px;

                                    }

                                    .number-box .btn {
                                        font-size: 16px;
                                        cursor: pointer;

                                    }
                                    .number-box .btn {
                                    padding: 0 8px;
                                }

                                }

                            }
                        }
                    }
                }
            }
            .main .deleteModal .deleteModalContainer {
                width: 300px;
                height: 240px;
                gap: 20%;
                .btns {
                    gap: 8px;
                    .btn {
                        width: 40%;
                    }
                }
            }
        }
        @media screen and (max-width: 430px) {
            .main .container .step img {
                width: 80%;
            }
            .main .container .step .stepText {
                width: 80%;
            }
            .main .container .cart .cartDetail .cartBody {
                padding: 0 8px;
            }
            .main .container .cart {
                .cartDetail {
                        .itemName {
                            width: 55%;
                        }

                        .price {
                            width: 20%;
                        }

                        .counter {
                            width: 25%;
                        }

                        .totalPrice {
                            display: none;
                        }

                        .trash {
                            display: none;
                        }
                }
            }
            .main .container .cart .cartDetail .cartBody .cartItem .itemName img {
                width: 30%;
            }
            .main .container .cart .cartDetail .cartBody .cartItem .itemName .goodsName {
                margin-left: 4px;
            }
            .main .container .cart .summary .checkoutBtn a {
                width: 280px;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="navLogo">
            <a href="./index.html">
                <img src="./img/navLogo.svg" alt="Logo">
            </a>
        </div>
        <nav class="navList">
            <ul>
                <li>
                    <a href="./about.html">關於我們</a>
                </li>
                <li>
                    <a href="./news.html">最新消息</a>
                </li>
                <li>
                    <a href="./area.html">門市資訊</a>
                </li>
                <li>
                    <a href="./store.html">所有商品</a>
                </li>
            </ul>
        </nav>
        <div class="icons">
            <a href="./contact.html">
                <img src="./img/letter.svg" alt="contact">
            </a>
            <a href="./cart.html" class="cartIcon">
                <img src="./img/cart.svg" alt="cart">
                <div class="cartNumber">1</div>
            </a>
        </div>
        <label class="hb">
            <input type="checkbox" class="menu-switch">
            <span class="bar bar1"></span>
            <span class="bar bar2"></span>
            <span class="bar bar3"></span>
        </label>
        <div class="backdrop"></div>
    </header>
    <section class="banner">
        <div class="title">
            <h1>CART</h1>
            <h2>購物車</h2>
        </div>
    </section>

    <div class="main">
        <div class="container">
            <div class="step">
                <img src="./img/step.png" alt="">
                <div class="stepText">
                    <span>Cart</span>
                    <span>Payment</span>
                    <span>Done</span>
                </div>
            </div>
            <div class="cart">
                <div class="cartDetail">
                    <div class="cartHeader">
                        <span class="itemName">商品名稱</span>
                        <span class="price">價格</span>
                        <span class="counter">數量</span>
                        <span class="totalPrice">小計</span>
                        <span class="trash">刪除</span>
                    </div>
                    <div class="cartBody">
                        <div class="cartItem">
                            <div class="itemName">
                                <img src="./img/cartGoods0.png" alt="">
                                <div class="goodsName">
                                    <h4>白金鼠魚</h4>
                                    <p>成魚</p>
                                </div>
                            </div>
                            <div class="price">
                                <span>
                                    $20
                                </span>
                            </div>
                            <div class="counter">
                                <div class="number-box">
                                    <button class="btn minus">-</button>
                                    <span class="value">1</span>
                                    <button class="btn plus">+</button>
                                </div>
                            </div>
                            <div class="totalPrice">
                                <span>
                                    $20
                                </span>
                            </div>
                            <div class="trash">
                                <img src="./img/Trash.svg" class="trashIcon" alt="">
                            </div>
                        </div>
                        <div class="cartItem">
                            <div class="itemName">
                                <img src="./img/cartGoods1.png" alt="">
                                <div class="goodsName">
                                    <h4>熊貓鼠魚</h4>
                                    <p>成魚</p>
                                </div>
                            </div>
                            <div class="price">
                                <span>
                                    $20
                                </span>
                            </div>
                            <div class="counter">
                                <div class="number-box">
                                    <button class="btn minus">-</button>
                                    <span class="value">1</span>
                                    <button class="btn plus">+</button>
                                </div>
                            </div>
                            <div class="totalPrice">
                                <span>
                                    $20
                                </span>
                            </div>
                            <div class="trash">
                                <img src="./img/Trash.svg" class="trashIcon" alt="">
                            </div>
                        </div>
                        <div class="cartItem">
                            <div class="itemName">
                                <img src="./img/cartGoods2.png" alt="">
                                <div class="goodsName">
                                    <h4>白色半月鬥魚</h4>
                                    <p>成魚</p>
                                </div>
                            </div>
                            <div class="price">
                                <span>
                                    $150
                                </span>
                            </div>
                            <div class="counter">
                                <div class="number-box">
                                    <button class="btn minus">-</button>
                                    <span class="value">1</span>
                                    <button class="btn plus">+</button>
                                </div>
                            </div>
                            <div class="totalPrice">
                                <span>
                                    $150
                                </span>
                            </div>
                            <div class="trash">
                                <img src="./img/Trash.svg" class="trashIcon" alt="">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="summary">
                    <div class="summaryTitle">
                        <h3>訂單總覽</h3>
                    </div>
                    <div class="summaryBody">
                        <div class="amount">
                            <div class="summaryCount">
                                <span>總數</span>
                                <span>3</span>
                            </div>
                            <div class="summaryTotal">
                                <span>合計</span>
                                <span>$190</span>
                            </div>
                            <div class="fee">
                                <span>運費</span>
                                <span>$30</span>
                            </div>
                        </div>
                        <div class="totalAmount">
                            <span>總價格</span>
                            <span>$220</span>
                        </div>
                    </div>
                    <div class="checkoutBtn">
                        <a href="">前往結帳</a>
                    </div>
                </div>
            </div>
            <div class="productSlogan">
                <div class="sloganItem">
                    <img src="./img/truck.svg" alt="truck">
                    <div class="sloganText">
                        <h4>免運費</h4>
                        <p>超過 $500 元即可享免運</p>
                    </div>
                </div>
                <div class="sloganItem">
                    <img src="./img/card.svg" alt="card">
                    <div class="sloganText">
                        <h4>多樣付款</h4>
                        <p>多種安全的付款選項</p>
                    </div>
                </div>
                <div class="sloganItem">
                    <img src="./img/headphone.svg" alt="headphone">
                    <div class="sloganText">
                        <h4>全年無休</h4>
                        <p>我們提供全天的線上支援</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="deleteModal">
            <div class="deleteModalContainer">
                <h4>確定移除這個商品嗎?</h4>
                <p>白金鼠魚</p>
                <div class="btns">
                    <button class="btn confirm">確定</button>
                    <button class="btn cancel">取消</button>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <div class="outer">

            <div class="footerlogo">
                <a href="./index.html">
                    <img src="./img/footerLogo.svg" alt="Logo">
                </a>
            </div>
            <div class="info">
                <p>營業時間 | 周一至周六09:30-20:00</p>
                <p>電話 | 03-8964426</p>
                <p>傳真 | 03-8964426</p>
                <p>地址 | 320桃園市中壢區復興路46號</p>
            </div>
            <div class="tag">
                <a href="./about.html">關於我們</a>
                <a href="./news.html">最新消息</a>
                <a href="./area.html">門市資訊</a>
                <a href="./store.html">所有商品</a>
            </div>
            <div class="icons">
                <a href="" class="icon">
                    <img src="./img/ic_fb.svg" alt="fb">
                </a>
                <a href="" class="icon">
                    <img src="./img/ic_ig.svg" alt="ig">
                </a>
                <a href="" class="icon">
                    <img src="./img/ic_twitter.svg" alt="twitter">
                </a>
            </div>
        </div>
    </footer>
    <script>
        // LocalStorage
        // 存數據
        // const cartList = [{
        //     goodsName : "白金鼠魚",
        //     goodsSize : "成魚",
        //     goodsPrice : 20,
        //     goodsQuantity:1,
        //     goodsPicNum: 0
        //     },
        //     {
        //     goodsName : "紅白蘭壽金魚",
        //     goodsSize : "成魚",
        //     goodsPrice : 50,
        //     goodsQuantity:1,
        //     goodsPicNum: 1
        //     },
        //     {
        //     goodsName : "白色半月鬥魚",
        //     goodsSize : "成魚",
        //     goodsPrice : 150,
        //     goodsQuantity:1,
        //     goodsPicNum: 2
        //     },
        //     {
        //     goodsName : "金絲神仙魚",
        //     goodsSize : "成魚",
        //     goodsPrice : 120,
        //     goodsQuantity:1,
        //     goodsPicNum: 3
        //     },
        //     {
        //     goodsName : "熊貓鼠魚",
        //     goodsSize : "成魚",
        //     goodsPrice : 20,
        //     goodsQuantity:1,
        //     goodsPicNum: 4
        //     },
        //     {
        //     goodsName : "雙色隆頭魚",
        //     goodsSize : "成魚",
        //     goodsPrice : 50,
        //     goodsQuantity:1,
        //     goodsPicNum: 5
        //     }
        // ];
        // localStorage.setItem("cartData", JSON.stringify(cartList));

        // 取數據
        let cartData = JSON.parse(localStorage.getItem("cartData")) || [];
        
        // 如果沒數據跳轉商品頁面
        if (cartData.length==0) {
            alert("購物車沒東西")
            window.location.href = "./store.html";
        }

        const cartItems = document.querySelectorAll(".cartItem")

        cartItems.forEach(function (cartItem) {
            cartItem.remove()
        })

        let totalQuantity=0
        let totalPrice= 0

        cartData.forEach(function (goodsData) {
            
            const cartBody = document.querySelector(".cartBody")
            cartBody.insertAdjacentHTML("beforeend", `<div class="cartItem">
                <div class="itemName">
                    <img src="./img/cartGoods${goodsData.goodsPicNum}.png" alt="">
                    <div class="goodsName">
                        <h4>${goodsData.goodsName}</h4>
                        <p>${goodsData.goodsSize}</p>
                    </div>
                </div>
                <div class="price">
                    <span>
                        $${goodsData.goodsPrice}
                    </span>
                </div>
                <div class="counter">
                    <div class="number-box">
                        <button class="btn minus">-</button>
                        <span class="value">${goodsData.goodsQuantity}</span>
                        <button class="btn plus">+</button>
                    </div>
                </div>
                <div class="totalPrice">
                    <span>
                        $${goodsData.goodsPrice*goodsData.goodsQuantity}
                    </span>
                </div>
                <div class="trash">
                    <img src="./img/Trash.svg" class="trashIcon" alt="">
                </div>
                </div>`);

            totalQuantity+=goodsData.goodsQuantity
            totalPrice+= goodsData.goodsPrice*goodsData.goodsQuantity
        })

        let summaryFee = 0

        if (totalPrice<500) {
            summaryFee=30
        }

        const summaryBody = document.querySelector(".summaryBody")

        summaryBody.innerHTML=`
        <div class="amount">
            <div class="summaryCount">
                <span>總數</span>
                <span>${totalQuantity}</span>
            </div>
            <div class="summaryTotal">
                <span>合計</span>
                <span>$${totalPrice}</span>
            </div>
            <div class="fee">
                <span>運費</span>
                <span>$${summaryFee}</span>
            </div>
        </div>
        <div class="totalAmount">
            <span>總價格</span>
            <span>$${totalPrice+summaryFee}</span>
        </div>
        `

        



        
        document.addEventListener("DOMContentLoaded",function () {
            // 計數器
            const boxs = document.querySelectorAll('.number-box');
            // 獲取訂單總攬數據
            const summaryCount = document.querySelector('.summaryCount').children[1]
            const summaryTotal = document.querySelector('.summaryTotal').children[1]
            const totalAmount = document.querySelector(".totalAmount").children[1]
            const fee = document.querySelector(".fee").children[1]


            // 刪除彈窗
            let modal = document.querySelector(".deleteModal")
            // 刪除彈窗內文
            let modalContent = modal.querySelector(".deleteModalContainer p")
            // 確認按鈕
            let modalConfirm = modal.querySelector(".confirm")
            // 取消按鈕
            let modalCancel = modal.querySelector(".cancel")
            // 確認窗口函式
            function confirmDetele(goodsItemName) {
                modal.classList.add("show")
                modalContent.textContent= goodsItemName
                return new Promise((resolve)=>{
                    // 點確認按鈕
                    modalConfirm.addEventListener("click",function () {  
                        modal.classList.remove("show")
                        resolve(true)
                    })
                    // 點取消按鈕
                    modalCancel.addEventListener("click",function () {
                        modal.classList.remove("show")
                        resolve(false)
                    })
                    // 點外面
                    modal.addEventListener("click",function () {
                        modal.classList.remove("show")
                        resolve(false)
                    })
                    // 點窗口
                    modal.querySelector(".deleteModalContainer").addEventListener("click",function (e) {
                        e.stopPropagation()
                    })
                })

            }

            // 對每個計數器上監聽器
            boxs.forEach(function (box) {
                const valueEl = box.querySelector('.value');
                
                let value = Number(valueEl.textContent);
                // 單一商品價格
                let price = box.parentElement.parentElement.querySelector(".price").children[0].innerHTML.replace("$", "")
                // 小計
                let totalPrice = box.parentElement.parentElement.querySelector(".totalPrice").children[0]
                //取商品名稱
                let goodsItemName=box.closest(".cartItem").children[0].children[1].children[0].textContent
                //商品
                let goodsItem=box.closest(".cartItem")
                
                // 減
                box.querySelector('.minus').onclick = async () => {
                    // 找array中對應索引直
                    let index = cartData.findIndex(item => item.goodsName === goodsItemName);
                    value--;
                    if (value < 1) {
                        
                        let ok = await confirmDetele(goodsItemName)
                        if (ok) {
                            cartData.splice(index, 1)
                            // 更新localStorage
                            localStorage.setItem("cartData", JSON.stringify(cartData));
                            //刪除此元素
                            goodsItem.classList.add('fadeOut');
                            setTimeout(()=> goodsItem.remove(), 700);

                            // 總數量
                            summaryCount.textContent--
            
                            let summaryTotalNum = Number(summaryTotal.textContent.replace("$", "")) - price * 1
            
                            summaryTotal.textContent = "$" + summaryTotalNum
            
                            // 總計500免運
                            if (summaryTotalNum >= 500) {
                                totalAmount.textContent = "$" + summaryTotalNum
                                fee.textContent = "$0"
                            } else {
                                totalAmount.textContent = "$" + (summaryTotalNum + 30)
                                fee.textContent = "$30"
                            }
                            // 如果沒數據跳轉商品頁面
                            if (cartData.length==0) {
                                alert("購物車沒東西")
                                window.location.href = "./store.html";
                            }
                        } else {
                            value = 1
                            
                        }
                        
                        return
                    }



                    cartData[index].goodsQuantity=value
                    // 更新localStorage
                    localStorage.setItem("cartData", JSON.stringify(cartData));

                    
    
                    valueEl.textContent = value;
                    totalPrice.textContent = "$" + price * value
                    // 總數量
                    summaryCount.textContent--
    
                    let summaryTotalNum = Number(summaryTotal.textContent.replace("$", "")) - price * 1
    
                    summaryTotal.textContent = "$" + summaryTotalNum
    
                    // 總計500免運
                    if (summaryTotalNum >= 500) {
                        totalAmount.textContent = "$" + summaryTotalNum
                        fee.textContent = "$0"
                    } else {
                        totalAmount.textContent = "$" + (summaryTotalNum + 30)
                        fee.textContent = "$30"
                    }
    
                };
                // 加
                box.querySelector('.plus').onclick = () => {
                    // 找array中對應索引直
                    let index = cartData.findIndex(item => item.goodsName === goodsItemName);
                    value++;

                    cartData[index].goodsQuantity=value
                    // 更新localStorage
                    localStorage.setItem("cartData", JSON.stringify(cartData));

                    valueEl.textContent = value;
                    totalPrice.textContent = "$" + price * value
                    summaryCount.textContent++
    
                    let summaryTotalNum = Number(summaryTotal.textContent.replace("$", "")) + price * 1
    
                    summaryTotal.textContent = "$" + summaryTotalNum
    
                    if (summaryTotalNum >= 500) {
                        totalAmount.textContent = "$" + summaryTotalNum
                        fee.textContent = "$0"
                    } else {
                        totalAmount.textContent = "$" + (summaryTotalNum + 30)
                        fee.textContent = "$30"
                    }
                };
    
                // 刪除icon邏輯
                let trash = goodsItem.querySelector(".trashIcon")
                trash.addEventListener("click", async function () {
                    // 找array中對應索引直
                    let index = cartData.findIndex(item => item.goodsName === goodsItemName);

                    let ok = await confirmDetele(goodsItemName)
                    if (ok) {
                            // 總數量
                            summaryCount.textContent-= cartData[index].goodsQuantity
                            // 總價
                            let summaryTotalNum = Number(summaryTotal.textContent.replace("$", "")) - price * cartData[index].goodsQuantity
            
                            summaryTotal.textContent = "$" + summaryTotalNum
            
                            // 總計500免運
                            if (summaryTotalNum >= 500) {
                                totalAmount.textContent = "$" + summaryTotalNum
                                fee.textContent = "$0"
                            } else {
                                totalAmount.textContent = "$" + (summaryTotalNum + 30)
                                fee.textContent = "$30"
                            }
                            cartData.splice(index, 1)
                            // 更新localStorage
                            localStorage.setItem("cartData", JSON.stringify(cartData));
                            //刪除此元素
                            goodsItem.classList.add('fadeOut');
                            setTimeout(()=> goodsItem.remove(), 700);

                            // 如果沒數據跳轉商品頁面
                            if (cartData.length==0) {
                                alert("購物車沒東西")
                                window.location.href = "./store.html";
                            }
                        }
                })
    
            })
    
    
    
        })
        
    </script>
    <script src="./hb.js"></script>
</body>

</html>